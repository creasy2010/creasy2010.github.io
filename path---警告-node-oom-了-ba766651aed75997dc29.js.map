{"version":3,"sources":["webpack:///path---警告-node-oom-了-ba766651aed75997dc29.js","webpack:///./.cache/json/警告-node-oom-了.json"],"names":["webpackJsonp","784","module","exports","data","post","id","html","htmlAst","type","children","tagName","properties","value","className","href","style","target","rel","alt","title","src","srcSet","sizes","quirksMode","fields","slug","prefix","frontmatter","subTitle","cover","author","footnote","site","siteMetadata","facebook","appId","pathContext"],"mappings":"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","file":"path---警告-node-oom-了-ba766651aed75997dc29.js","sourcesContent":["webpackJsonp([64197529879269],{\n\n/***/ 784:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"post\":{\"id\":\"/Users/dong/dong/blogs/content/posts/2019-01-28--警告\\\"node OOM\\\"了/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>bug还没解决,如何过年?</p>\\n<p>不是标题党,确实是出了线上问题, 线上不间断出现oom问题,还有一周就过年了,问题不解决,如何能安心过年,过年的时候出问题,估计客户会把我们撕的碎碎的.</p>\\n<p>为什么说 “5块钱的bug,怎么变成了用1.5W的成本”? 如果及早发现这个问题,一个人5分钟就搞定,但我们三个人却用了5天(包含周未);</p>\\n<h2>现象</h2>\\n<p>在”主动发现问题行动”的推动下配置了alinode的告警,然后就有报警出现了,. </p>\\n<p>报警: “已用堆内存超过堆上限的 80%，当前为 82.31%“;</p>\\n<p>再仔细一查, 不得了了.比报警内容还坏, 我们遇到的不是内存泄漏,而是oom崩溃, 而且是突发式的.一但发生立马崩溃,不给你半点时间;\\n幸好进程会自动拉起. nginx也有健康状态检查,会自动分流; </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-200f3.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.44386422976501%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABc0lEQVQoz61SXU/CQBDs3/bZB1+NCEpM0BhBrARJ9Ff47E9ATYiQAu19362z26viu4TJTuf25m62LY6OT2jx/EJ305ImD49/cF/OaFKCo47xzJh0Gvh0Nqex7CvpCR7lfEHF6esb/eevGF7fCqnqhvbaUJ2xA9Z7aND52Xsv64ymg0FPo2mzb/ca56gY3bSG1nmKMZH1gQw2OyClRCFGwS9PFMFNCOj1osWDnmJ4NRJDD3dZQGMEuEpTBq8laCCCVg8/6wyPw4qz/oUY1lpLLJ9vp3HjDeIoa+XWfHplHFXW0Rr1C1gBa20R19JKO1IhUnE+uBTDHUQncQPVFvOCYWVQwRU0jrkF37qAtYDqaZfBhyvA45ZFr98a+jwzFr1ERjRK+Lfg+LzR5WgW1aDHCk+iywx7g6EYGtO+yZDn53ErjXisxTzPD2VpqRy9H2DZWNE/AcuRO0OF1+7y/BgcfcufAkxdjqzAVY7XoWHNWHAnh34DQ6P021JG5RoAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"cpu   \\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-48538.png\\\"\\n        srcset=\\\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-bed0f.png 200w,\\n/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-5fd34.png 400w,\\n/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-48538.png 800w,\\n/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-b70ec.png 1200w,\\n/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-d134a.png 1600w,\\n/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-200f3.png 1915w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>随后开启服务器coredump,把进程崩溃的现场信息留下来,等了一天,便可以在alinode管理端获取coredump列表.</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b9b8f.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.62565172054223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABe0lEQVQoz3WRWUsDMRSF50cLgg8+CvrghgWtWqa009YK+p9E0E5mXzJLJjneJNM6dQkccudOzpeTxDk4Oob39IzxxMWjO8Xh2MXJZA5vsYTrLTEdar7YySXNFiu4s7nR+uUV3moNZ3Q/gR6VBBqaP2hmpBZWVJp+1UsO1A1qvVaRnKvRLZK2gx+ECKIYWZKiyHNEaYpNxODTd0BK8wJJVlA/R0b1nooSSRyTr4Bzc/cAn8jaxFiAoiyhpEKnBHzO8FY1SOrWnEIphbKTZrZD6aatKvK1DZxLShhQI0wzhFGEknNIDZQCjId4J2Ba2wNJMnMCtvRfmE2VgSsD5BZ4en6NsE8YhCHKbUIDDAww6YHaXBOwlhKNtOBvYJ/w7OIHcC8hHZk3iAfAqk+o0+0n/AfIe6CQLd1hgrARKFuxA7bSJtRJdcr/gXSHrE+oeuAnLRJk7LrOGkmSIPYh1G6TX8CIGixOsGHM3KE2dQTcVAUaISHEPnBbqz8e5Qskv+7Nf51IDgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"alinodecoredump  \\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-48538.png\\\"\\n        srcset=\\\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-bed0f.png 200w,\\n/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-5fd34.png 400w,\\n/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-48538.png 800w,\\n/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b70ec.png 1200w,\\n/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-d134a.png 1600w,\\n/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b9b8f.png 1918w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>有了这些信息,就可以开展分析工作了;</p>\\n<h2>线索</h2>\\n<ol>\\n<li>崩溃不定期发生,然而线上机器大概率发生, 灰度 机器并不发生;一台机器中个别进程崩溃;</li>\\n<li>查看其他应用并没有发生崩溃的问题; </li>\\n<li>近期上了健康检查与全链路跟踪; </li>\\n<li>线上虽有崩溃,然而并没有用户反馈有问题;</li>\\n<li>有3种崩溃的情况,不只是一种;</li>\\n</ol>\\n<h2>解决角度</h2>\\n<p>根据对coredump内容分析,有三个解决角度</p>\\n<ol>\\n<li>查看heap中占比最大的对象;</li>\\n<li>zoneContext导致;</li>\\n<li>urllib所发出的请求导致出问题; </li>\\n</ol>\\n<p>看了之后特别怀疑问题2, 原因有两点: </p>\\n<ol>\\n<li>最近我们上线了zipkin全链路跟踪;</li>\\n<li>zoneContex 所使用的async_hook还是实验特性 (不会入坑了吧. );</li>\\n<li>nginx有健康检查,会不停发请求; </li>\\n</ol>\\n<h3>线索1:查看heap中占比最大的对象</h3>\\n<p>本以为手到病除, 然而一看coredump中对象列表就傻眼了.没有统计,没有规律,只显示object有600多M,但是什么对象就是找不到.\\n就好比告诉你凶手就在茫茫人海中,说了几乎跟没说一样.. </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/objectlist-a05ede811a97962799580ec1102498f4-3bb64.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.470219435736674%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABTklEQVQoz61S204CMRTc3/bJB/9A0GCQ4BUVCGiMv2RUILvb7b1bxtnuSngTE5tMzml7MmfOtNnR8QlmyxeMb+9xfTdJmDzN8DCdp/iT7+8n0zY+zhftPfH8+obpYomsIUhru8V/rOzicow6RryvNsiFhJAKZSWZV5DawHsPYy0s4Zg718B1sb0zxqazpjYbjW8obgupFJTRUFpDG7ODtW5HoHmnlN6RSjZvyXyqS4TD0VWSKnmgvYNioSE098qSwIfU8FBk/V6f/kWUmy8YkcPJiqPV7Fa3I9YB8U+E54OkMM8/oasCmmMoa1p1LtDftjAeTDgYJkJhVDeygXA6KavriLp5/T38SnjWKVznBV+34CsLVMrQx0BfVfJSu5rNYlLc2BFCICIcowueOS3iPsRG4WkPoBqx/oAqV/CigC9zRCptxoz8UrEbOR4w+jeYYvTBidXgwwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"objectlist\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/objectlist-a05ede811a97962799580ec1102498f4-48538.png\\\"\\n        srcset=\\\"/static/objectlist-a05ede811a97962799580ec1102498f4-bed0f.png 200w,\\n/static/objectlist-a05ede811a97962799580ec1102498f4-5fd34.png 400w,\\n/static/objectlist-a05ede811a97962799580ec1102498f4-48538.png 800w,\\n/static/objectlist-a05ede811a97962799580ec1102498f4-b70ec.png 1200w,\\n/static/objectlist-a05ede811a97962799580ec1102498f4-d134a.png 1600w,\\n/static/objectlist-a05ede811a97962799580ec1102498f4-3bb64.png 1914w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>尝试用概率的方法来人肉统计一次,然而次次无功而返;当然不依赖alinode对coredump进行分析,然而考虑到时间成本再试下别一个角度</p>\\n<h3>线索2:zoneContext导致</h3>\\n<p>朝着这个方向走,检查了zonecontext的代码,然而并没有看出什么问题, 只好忌出大法(范围缩小跟踪)</p>\\n<p>我们使用zonecontext的地方有两个,1) 全链路跟踪,2) dubbolog . 而 全链路跟踪是新上的功能,且是关键节点,dubbolog记录是很久上的,且业务应用也有使用</p>\\n<p>我们选择关闭了zipkin全链路跟踪,关闭了nginx健康检查(会发送大量请求); </p>\\n<p>理想总是美好的, 然而实现却啪啪啪的打脸. 把这些都关闭了线上还在出问题;囧了. 众多迹象证明问题不在zonecontext&#x26;async_hook</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-55c5b.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.36534446764092%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABQElEQVQoz62R20oDMRRF5799EPwBL9WiWKRY6/RKKVj0p+zccptkZrY7SS31RefBwOLMIWHNSXZydn6B3fsHJukcr/MlZqs10sUKL+xny3VgOlsETvuUdbHehHOTaYrt2w6rzRbJaPwMv9q2xX+sZHD/iEwqFFkOxSqFYJXQRFZV7LWGJtLvKwWldKi+14c9peJ38vg0DuY8K5FXFJNSkEJAEqsNmqbpSYtk+DAKwk9pkCmHvbLItYOyDeq2Q3e8TBfout9JLm/uwvF9pSmsef0auZcSVTsI42Bc/LvnT+HV7TAKhRdGUantUVpwWo+sG7i2j3AQhRknzKUN0oLCgtOWnFYZi4YTdnyjro/w+iAsMsVQahSUCoZimbITEvYbJtpY13/C8IaUVZxMMCBp4jU9xrUnMCyiGZrxwbmfU38BNrX0HLADTrYAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"  1\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-48538.png\\\"\\n        srcset=\\\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-bed0f.png 200w,\\n/static/原因1-f157a782dc7a105fbcaeba2171ae4733-5fd34.png 400w,\\n/static/原因1-f157a782dc7a105fbcaeba2171ae4733-48538.png 800w,\\n/static/原因1-f157a782dc7a105fbcaeba2171ae4733-b70ec.png 1200w,\\n/static/原因1-f157a782dc7a105fbcaeba2171ae4733-d134a.png 1600w,\\n/static/原因1-f157a782dc7a105fbcaeba2171ae4733-55c5b.png 1916w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/原因2-8476e1f72ff45b0e087e85029010b116-09816.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.54887611082071%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABdElEQVQoz52R227UMBRF8+E8VOIHqCoEiGlLp+k0HbVIFV+EaKYT6CR24nh8zWbbYUB94CIsLe1zLHn5WC5eHL3E+v4TFssVTssKi8trnDE/XFU4J8vrG1xVa5TMMuUB9qv1LS5XFesKd3RUtx9RpI20PIkkkAn/v4rF+TKLvgqFp2GfadXz7EaDYW+hjYP3Ho7431BclKtsbtNB7dCODv3eQbCWTO0ClPWwPiDGCdP0ZzjhRRbuKEySgyhlEhkfKeMbpr/LsvD12/ezsNc/ZbPQomffp2RvOOE/Cd+8W2ShEEnoIfZ+liaRsjBKIziPECOffGDKH8fzcx6YhfOEcjdA9nx2/gQLqQwka9MPsELCdgImJXuvNaJ3mIJ/Di8rTl4dA4PC5vMWTd3gC6m3LR6aDo/NE3b1I8TDhtSQNXOzhWi+QXVdZuBFw66FFi2iVijK9MshcELJCUf0RMsBioy8yI06TxSs/YFBdHbG2l81SVN+B9R48ELdeLncAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"  2\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/原因2-8476e1f72ff45b0e087e85029010b116-48538.png\\\"\\n        srcset=\\\"/static/原因2-8476e1f72ff45b0e087e85029010b116-bed0f.png 200w,\\n/static/原因2-8476e1f72ff45b0e087e85029010b116-5fd34.png 400w,\\n/static/原因2-8476e1f72ff45b0e087e85029010b116-48538.png 800w,\\n/static/原因2-8476e1f72ff45b0e087e85029010b116-b70ec.png 1200w,\\n/static/原因2-8476e1f72ff45b0e087e85029010b116-d134a.png 1600w,\\n/static/原因2-8476e1f72ff45b0e087e85029010b116-09816.png 1913w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\",\"htmlAst\":{\"type\":\"root\",\"children\":[{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"bug还没解决,如何过年?\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"不是标题党,确实是出了线上问题, 线上不间断出现oom问题,还有一周就过年了,问题不解决,如何能安心过年,过年的时候出问题,估计客户会把我们撕的碎碎的.\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"为什么说 “5块钱的bug,怎么变成了用1.5W的成本”? 如果及早发现这个问题,一个人5分钟就搞定,但我们三个人却用了5天(包含周未);\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"现象\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"在”主动发现问题行动”的推动下配置了alinode的告警,然后就有报警出现了,. \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"报警: “已用堆内存超过堆上限的 80%，当前为 82.31%“;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"再仔细一查, 不得了了.比报警内容还坏, 我们遇到的不是内存泄漏,而是oom崩溃, 而且是突发式的.一但发生立马崩溃,不给你半点时间;\\n幸好进程会自动拉起. nginx也有健康状态检查,会自动分流; \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-200f3.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.44386422976501%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABc0lEQVQoz61SXU/CQBDs3/bZB1+NCEpM0BhBrARJ9Ff47E9ATYiQAu19362z26viu4TJTuf25m62LY6OT2jx/EJ305ImD49/cF/OaFKCo47xzJh0Gvh0Nqex7CvpCR7lfEHF6esb/eevGF7fCqnqhvbaUJ2xA9Z7aND52Xsv64ymg0FPo2mzb/ca56gY3bSG1nmKMZH1gQw2OyClRCFGwS9PFMFNCOj1osWDnmJ4NRJDD3dZQGMEuEpTBq8laCCCVg8/6wyPw4qz/oUY1lpLLJ9vp3HjDeIoa+XWfHplHFXW0Rr1C1gBa20R19JKO1IhUnE+uBTDHUQncQPVFvOCYWVQwRU0jrkF37qAtYDqaZfBhyvA45ZFr98a+jwzFr1ERjRK+Lfg+LzR5WgW1aDHCk+iywx7g6EYGtO+yZDn53ErjXisxTzPD2VpqRy9H2DZWNE/AcuRO0OF1+7y/BgcfcufAkxdjqzAVY7XoWHNWHAnh34DQ6P021JG5RoAAAAASUVORK5CYII='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"cpu   \",\"title\":\"\",\"src\":\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-48538.png\",\"srcSet\":[\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-bed0f.png 200w\",\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-5fd34.png 400w\",\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-48538.png 800w\",\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-b70ec.png 1200w\",\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-d134a.png 1600w\",\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-200f3.png 1915w\"],\"sizes\":[\"(max-width:\",\"800px)\",\"100vw,\",\"800px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"随后开启服务器coredump,把进程崩溃的现场信息留下来,等了一天,便可以在alinode管理端获取coredump列表.\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b9b8f.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.62565172054223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABe0lEQVQoz3WRWUsDMRSF50cLgg8+CvrghgWtWqa009YK+p9E0E5mXzJLJjneJNM6dQkccudOzpeTxDk4Oob39IzxxMWjO8Xh2MXJZA5vsYTrLTEdar7YySXNFiu4s7nR+uUV3moNZ3Q/gR6VBBqaP2hmpBZWVJp+1UsO1A1qvVaRnKvRLZK2gx+ECKIYWZKiyHNEaYpNxODTd0BK8wJJVlA/R0b1nooSSRyTr4Bzc/cAn8jaxFiAoiyhpEKnBHzO8FY1SOrWnEIphbKTZrZD6aatKvK1DZxLShhQI0wzhFGEknNIDZQCjId4J2Ba2wNJMnMCtvRfmE2VgSsD5BZ4en6NsE8YhCHKbUIDDAww6YHaXBOwlhKNtOBvYJ/w7OIHcC8hHZk3iAfAqk+o0+0n/AfIe6CQLd1hgrARKFuxA7bSJtRJdcr/gXSHrE+oeuAnLRJk7LrOGkmSIPYh1G6TX8CIGixOsGHM3KE2dQTcVAUaISHEPnBbqz8e5Qskv+7Nf51IDgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"alinodecoredump  \",\"title\":\"\",\"src\":\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-48538.png\",\"srcSet\":[\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-bed0f.png 200w\",\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-5fd34.png 400w\",\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-48538.png 800w\",\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b70ec.png 1200w\",\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-d134a.png 1600w\",\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b9b8f.png 1918w\"],\"sizes\":[\"(max-width:\",\"800px)\",\"100vw,\",\"800px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"有了这些信息,就可以开展分析工作了;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"线索\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"崩溃不定期发生,然而线上机器大概率发生, 灰度 机器并不发生;一台机器中个别进程崩溃;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"查看其他应用并没有发生崩溃的问题; \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"近期上了健康检查与全链路跟踪; \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"线上虽有崩溃,然而并没有用户反馈有问题;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"有3种崩溃的情况,不只是一种;\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"解决角度\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"根据对coredump内容分析,有三个解决角度\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"查看heap中占比最大的对象;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"zoneContext导致;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"urllib所发出的请求导致出问题; \"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"看了之后特别怀疑问题2, 原因有两点: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"最近我们上线了zipkin全链路跟踪;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"zoneContex 所使用的async_hook还是实验特性 (不会入坑了吧. );\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"nginx有健康检查,会不停发请求; \"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"线索1:查看heap中占比最大的对象\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"本以为手到病除, 然而一看coredump中对象列表就傻眼了.没有统计,没有规律,只显示object有600多M,但是什么对象就是找不到.\\n就好比告诉你凶手就在茫茫人海中,说了几乎跟没说一样.. \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/objectlist-a05ede811a97962799580ec1102498f4-3bb64.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.470219435736674%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABTklEQVQoz61S204CMRTc3/bJB/9A0GCQ4BUVCGiMv2RUILvb7b1bxtnuSngTE5tMzml7MmfOtNnR8QlmyxeMb+9xfTdJmDzN8DCdp/iT7+8n0zY+zhftPfH8+obpYomsIUhru8V/rOzicow6RryvNsiFhJAKZSWZV5DawHsPYy0s4Zg718B1sb0zxqazpjYbjW8obgupFJTRUFpDG7ODtW5HoHmnlN6RSjZvyXyqS4TD0VWSKnmgvYNioSE098qSwIfU8FBk/V6f/kWUmy8YkcPJiqPV7Fa3I9YB8U+E54OkMM8/oasCmmMoa1p1LtDftjAeTDgYJkJhVDeygXA6KavriLp5/T38SnjWKVznBV+34CsLVMrQx0BfVfJSu5rNYlLc2BFCICIcowueOS3iPsRG4WkPoBqx/oAqV/CigC9zRCptxoz8UrEbOR4w+jeYYvTBidXgwwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"objectlist\",\"title\":\"\",\"src\":\"/static/objectlist-a05ede811a97962799580ec1102498f4-48538.png\",\"srcSet\":[\"/static/objectlist-a05ede811a97962799580ec1102498f4-bed0f.png 200w\",\"/static/objectlist-a05ede811a97962799580ec1102498f4-5fd34.png 400w\",\"/static/objectlist-a05ede811a97962799580ec1102498f4-48538.png 800w\",\"/static/objectlist-a05ede811a97962799580ec1102498f4-b70ec.png 1200w\",\"/static/objectlist-a05ede811a97962799580ec1102498f4-d134a.png 1600w\",\"/static/objectlist-a05ede811a97962799580ec1102498f4-3bb64.png 1914w\"],\"sizes\":[\"(max-width:\",\"800px)\",\"100vw,\",\"800px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"尝试用概率的方法来人肉统计一次,然而次次无功而返;当然不依赖alinode对coredump进行分析,然而考虑到时间成本再试下别一个角度\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"线索2:zoneContext导致\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"朝着这个方向走,检查了zonecontext的代码,然而并没有看出什么问题, 只好忌出大法(范围缩小跟踪)\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"我们使用zonecontext的地方有两个,1) 全链路跟踪,2) dubbolog . 而 全链路跟踪是新上的功能,且是关键节点,dubbolog记录是很久上的,且业务应用也有使用\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"我们选择关闭了zipkin全链路跟踪,关闭了nginx健康检查(会发送大量请求); \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"理想总是美好的, 然而实现却啪啪啪的打脸. 把这些都关闭了线上还在出问题;囧了. 众多迹象证明问题不在zonecontext&async_hook\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-55c5b.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.36534446764092%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABQElEQVQoz62R20oDMRRF5799EPwBL9WiWKRY6/RKKVj0p+zccptkZrY7SS31RefBwOLMIWHNSXZydn6B3fsHJukcr/MlZqs10sUKL+xny3VgOlsETvuUdbHehHOTaYrt2w6rzRbJaPwMv9q2xX+sZHD/iEwqFFkOxSqFYJXQRFZV7LWGJtLvKwWldKi+14c9peJ38vg0DuY8K5FXFJNSkEJAEqsNmqbpSYtk+DAKwk9pkCmHvbLItYOyDeq2Q3e8TBfout9JLm/uwvF9pSmsef0auZcSVTsI42Bc/LvnT+HV7TAKhRdGUantUVpwWo+sG7i2j3AQhRknzKUN0oLCgtOWnFYZi4YTdnyjro/w+iAsMsVQahSUCoZimbITEvYbJtpY13/C8IaUVZxMMCBp4jU9xrUnMCyiGZrxwbmfU38BNrX0HLADTrYAAAAASUVORK5CYII='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"  1\",\"title\":\"\",\"src\":\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-48538.png\",\"srcSet\":[\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-bed0f.png 200w\",\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-5fd34.png 400w\",\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-48538.png 800w\",\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-b70ec.png 1200w\",\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-d134a.png 1600w\",\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-55c5b.png 1916w\"],\"sizes\":[\"(max-width:\",\"800px)\",\"100vw,\",\"800px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/原因2-8476e1f72ff45b0e087e85029010b116-09816.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.54887611082071%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABdElEQVQoz52R227UMBRF8+E8VOIHqCoEiGlLp+k0HbVIFV+EaKYT6CR24nh8zWbbYUB94CIsLe1zLHn5WC5eHL3E+v4TFssVTssKi8trnDE/XFU4J8vrG1xVa5TMMuUB9qv1LS5XFesKd3RUtx9RpI20PIkkkAn/v4rF+TKLvgqFp2GfadXz7EaDYW+hjYP3Ho7431BclKtsbtNB7dCODv3eQbCWTO0ClPWwPiDGCdP0ZzjhRRbuKEySgyhlEhkfKeMbpr/LsvD12/ezsNc/ZbPQomffp2RvOOE/Cd+8W2ShEEnoIfZ+liaRsjBKIziPECOffGDKH8fzcx6YhfOEcjdA9nx2/gQLqQwka9MPsELCdgImJXuvNaJ3mIJ/Di8rTl4dA4PC5vMWTd3gC6m3LR6aDo/NE3b1I8TDhtSQNXOzhWi+QXVdZuBFw66FFi2iVijK9MshcELJCUf0RMsBioy8yI06TxSs/YFBdHbG2l81SVN+B9R48ELdeLncAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"  2\",\"title\":\"\",\"src\":\"/static/原因2-8476e1f72ff45b0e087e85029010b116-48538.png\",\"srcSet\":[\"/static/原因2-8476e1f72ff45b0e087e85029010b116-bed0f.png 200w\",\"/static/原因2-8476e1f72ff45b0e087e85029010b116-5fd34.png 400w\",\"/static/原因2-8476e1f72ff45b0e087e85029010b116-48538.png 800w\",\"/static/原因2-8476e1f72ff45b0e087e85029010b116-b70ec.png 1200w\",\"/static/原因2-8476e1f72ff45b0e087e85029010b116-d134a.png 1600w\",\"/static/原因2-8476e1f72ff45b0e087e85029010b116-09816.png 1913w\"],\"sizes\":[\"(max-width:\",\"800px)\",\"100vw,\",\"800px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]}],\"data\":{\"quirksMode\":false}},\"fields\":{\"slug\":\"/警告\\\"node OOM\\\"了/\",\"prefix\":\"2019-01-28\"},\"frontmatter\":{\"title\":\"bug不解决,如何过年-node OOM\",\"subTitle\":\"5块钱的bug,怎么变成了用1.5W的成本 !\",\"cover\":null}},\"author\":{\"id\":\"/Users/dong/dong/blogs/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>游大千世界,看大千世界,认知世界!</p>\"},\"footnote\":{\"id\":\"/Users/dong/dong/blogs/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>I am a coder who solves the problem<a href=\\\"/about/\\\">contact</a></p>\"},\"site\":{\"siteMetadata\":{\"facebook\":{\"appId\":\"coder.yang2001@gmail.com\"}}}},\"pathContext\":{\"slug\":\"/警告\\\"node OOM\\\"了/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---警告-node-oom-了-ba766651aed75997dc29.js","module.exports = {\"data\":{\"post\":{\"id\":\"/Users/dong/dong/blogs/content/posts/2019-01-28--警告\\\"node OOM\\\"了/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>bug还没解决,如何过年?</p>\\n<p>不是标题党,确实是出了线上问题, 线上不间断出现oom问题,还有一周就过年了,问题不解决,如何能安心过年,过年的时候出问题,估计客户会把我们撕的碎碎的.</p>\\n<p>为什么说 “5块钱的bug,怎么变成了用1.5W的成本”? 如果及早发现这个问题,一个人5分钟就搞定,但我们三个人却用了5天(包含周未);</p>\\n<h2>现象</h2>\\n<p>在”主动发现问题行动”的推动下配置了alinode的告警,然后就有报警出现了,. </p>\\n<p>报警: “已用堆内存超过堆上限的 80%，当前为 82.31%“;</p>\\n<p>再仔细一查, 不得了了.比报警内容还坏, 我们遇到的不是内存泄漏,而是oom崩溃, 而且是突发式的.一但发生立马崩溃,不给你半点时间;\\n幸好进程会自动拉起. nginx也有健康状态检查,会自动分流; </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-200f3.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.44386422976501%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABc0lEQVQoz61SXU/CQBDs3/bZB1+NCEpM0BhBrARJ9Ff47E9ATYiQAu19362z26viu4TJTuf25m62LY6OT2jx/EJ305ImD49/cF/OaFKCo47xzJh0Gvh0Nqex7CvpCR7lfEHF6esb/eevGF7fCqnqhvbaUJ2xA9Z7aND52Xsv64ymg0FPo2mzb/ca56gY3bSG1nmKMZH1gQw2OyClRCFGwS9PFMFNCOj1osWDnmJ4NRJDD3dZQGMEuEpTBq8laCCCVg8/6wyPw4qz/oUY1lpLLJ9vp3HjDeIoa+XWfHplHFXW0Rr1C1gBa20R19JKO1IhUnE+uBTDHUQncQPVFvOCYWVQwRU0jrkF37qAtYDqaZfBhyvA45ZFr98a+jwzFr1ERjRK+Lfg+LzR5WgW1aDHCk+iywx7g6EYGtO+yZDn53ErjXisxTzPD2VpqRy9H2DZWNE/AcuRO0OF1+7y/BgcfcufAkxdjqzAVY7XoWHNWHAnh34DQ6P021JG5RoAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"cpu   \\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-48538.png\\\"\\n        srcset=\\\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-bed0f.png 200w,\\n/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-5fd34.png 400w,\\n/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-48538.png 800w,\\n/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-b70ec.png 1200w,\\n/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-d134a.png 1600w,\\n/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-200f3.png 1915w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>随后开启服务器coredump,把进程崩溃的现场信息留下来,等了一天,便可以在alinode管理端获取coredump列表.</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b9b8f.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.62565172054223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABe0lEQVQoz3WRWUsDMRSF50cLgg8+CvrghgWtWqa009YK+p9E0E5mXzJLJjneJNM6dQkccudOzpeTxDk4Oob39IzxxMWjO8Xh2MXJZA5vsYTrLTEdar7YySXNFiu4s7nR+uUV3moNZ3Q/gR6VBBqaP2hmpBZWVJp+1UsO1A1qvVaRnKvRLZK2gx+ECKIYWZKiyHNEaYpNxODTd0BK8wJJVlA/R0b1nooSSRyTr4Bzc/cAn8jaxFiAoiyhpEKnBHzO8FY1SOrWnEIphbKTZrZD6aatKvK1DZxLShhQI0wzhFGEknNIDZQCjId4J2Ba2wNJMnMCtvRfmE2VgSsD5BZ4en6NsE8YhCHKbUIDDAww6YHaXBOwlhKNtOBvYJ/w7OIHcC8hHZk3iAfAqk+o0+0n/AfIe6CQLd1hgrARKFuxA7bSJtRJdcr/gXSHrE+oeuAnLRJk7LrOGkmSIPYh1G6TX8CIGixOsGHM3KE2dQTcVAUaISHEPnBbqz8e5Qskv+7Nf51IDgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"alinodecoredump  \\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-48538.png\\\"\\n        srcset=\\\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-bed0f.png 200w,\\n/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-5fd34.png 400w,\\n/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-48538.png 800w,\\n/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b70ec.png 1200w,\\n/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-d134a.png 1600w,\\n/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b9b8f.png 1918w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>有了这些信息,就可以开展分析工作了;</p>\\n<h2>线索</h2>\\n<ol>\\n<li>崩溃不定期发生,然而线上机器大概率发生, 灰度 机器并不发生;一台机器中个别进程崩溃;</li>\\n<li>查看其他应用并没有发生崩溃的问题; </li>\\n<li>近期上了健康检查与全链路跟踪; </li>\\n<li>线上虽有崩溃,然而并没有用户反馈有问题;</li>\\n<li>有3种崩溃的情况,不只是一种;</li>\\n</ol>\\n<h2>解决角度</h2>\\n<p>根据对coredump内容分析,有三个解决角度</p>\\n<ol>\\n<li>查看heap中占比最大的对象;</li>\\n<li>zoneContext导致;</li>\\n<li>urllib所发出的请求导致出问题; </li>\\n</ol>\\n<p>看了之后特别怀疑问题2, 原因有两点: </p>\\n<ol>\\n<li>最近我们上线了zipkin全链路跟踪;</li>\\n<li>zoneContex 所使用的async_hook还是实验特性 (不会入坑了吧. );</li>\\n<li>nginx有健康检查,会不停发请求; </li>\\n</ol>\\n<h3>线索1:查看heap中占比最大的对象</h3>\\n<p>本以为手到病除, 然而一看coredump中对象列表就傻眼了.没有统计,没有规律,只显示object有600多M,但是什么对象就是找不到.\\n就好比告诉你凶手就在茫茫人海中,说了几乎跟没说一样.. </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/objectlist-a05ede811a97962799580ec1102498f4-3bb64.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.470219435736674%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABTklEQVQoz61S204CMRTc3/bJB/9A0GCQ4BUVCGiMv2RUILvb7b1bxtnuSngTE5tMzml7MmfOtNnR8QlmyxeMb+9xfTdJmDzN8DCdp/iT7+8n0zY+zhftPfH8+obpYomsIUhru8V/rOzicow6RryvNsiFhJAKZSWZV5DawHsPYy0s4Zg718B1sb0zxqazpjYbjW8obgupFJTRUFpDG7ODtW5HoHmnlN6RSjZvyXyqS4TD0VWSKnmgvYNioSE098qSwIfU8FBk/V6f/kWUmy8YkcPJiqPV7Fa3I9YB8U+E54OkMM8/oasCmmMoa1p1LtDftjAeTDgYJkJhVDeygXA6KavriLp5/T38SnjWKVznBV+34CsLVMrQx0BfVfJSu5rNYlLc2BFCICIcowueOS3iPsRG4WkPoBqx/oAqV/CigC9zRCptxoz8UrEbOR4w+jeYYvTBidXgwwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"objectlist\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/objectlist-a05ede811a97962799580ec1102498f4-48538.png\\\"\\n        srcset=\\\"/static/objectlist-a05ede811a97962799580ec1102498f4-bed0f.png 200w,\\n/static/objectlist-a05ede811a97962799580ec1102498f4-5fd34.png 400w,\\n/static/objectlist-a05ede811a97962799580ec1102498f4-48538.png 800w,\\n/static/objectlist-a05ede811a97962799580ec1102498f4-b70ec.png 1200w,\\n/static/objectlist-a05ede811a97962799580ec1102498f4-d134a.png 1600w,\\n/static/objectlist-a05ede811a97962799580ec1102498f4-3bb64.png 1914w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>尝试用概率的方法来人肉统计一次,然而次次无功而返;当然不依赖alinode对coredump进行分析,然而考虑到时间成本再试下别一个角度</p>\\n<h3>线索2:zoneContext导致</h3>\\n<p>朝着这个方向走,检查了zonecontext的代码,然而并没有看出什么问题, 只好忌出大法(范围缩小跟踪)</p>\\n<p>我们使用zonecontext的地方有两个,1) 全链路跟踪,2) dubbolog . 而 全链路跟踪是新上的功能,且是关键节点,dubbolog记录是很久上的,且业务应用也有使用</p>\\n<p>我们选择关闭了zipkin全链路跟踪,关闭了nginx健康检查(会发送大量请求); </p>\\n<p>理想总是美好的, 然而实现却啪啪啪的打脸. 把这些都关闭了线上还在出问题;囧了. 众多迹象证明问题不在zonecontext&#x26;async_hook</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-55c5b.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.36534446764092%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABQElEQVQoz62R20oDMRRF5799EPwBL9WiWKRY6/RKKVj0p+zccptkZrY7SS31RefBwOLMIWHNSXZydn6B3fsHJukcr/MlZqs10sUKL+xny3VgOlsETvuUdbHehHOTaYrt2w6rzRbJaPwMv9q2xX+sZHD/iEwqFFkOxSqFYJXQRFZV7LWGJtLvKwWldKi+14c9peJ38vg0DuY8K5FXFJNSkEJAEqsNmqbpSYtk+DAKwk9pkCmHvbLItYOyDeq2Q3e8TBfout9JLm/uwvF9pSmsef0auZcSVTsI42Bc/LvnT+HV7TAKhRdGUantUVpwWo+sG7i2j3AQhRknzKUN0oLCgtOWnFYZi4YTdnyjro/w+iAsMsVQahSUCoZimbITEvYbJtpY13/C8IaUVZxMMCBp4jU9xrUnMCyiGZrxwbmfU38BNrX0HLADTrYAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"  1\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-48538.png\\\"\\n        srcset=\\\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-bed0f.png 200w,\\n/static/原因1-f157a782dc7a105fbcaeba2171ae4733-5fd34.png 400w,\\n/static/原因1-f157a782dc7a105fbcaeba2171ae4733-48538.png 800w,\\n/static/原因1-f157a782dc7a105fbcaeba2171ae4733-b70ec.png 1200w,\\n/static/原因1-f157a782dc7a105fbcaeba2171ae4733-d134a.png 1600w,\\n/static/原因1-f157a782dc7a105fbcaeba2171ae4733-55c5b.png 1916w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/原因2-8476e1f72ff45b0e087e85029010b116-09816.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 50.54887611082071%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABdElEQVQoz52R227UMBRF8+E8VOIHqCoEiGlLp+k0HbVIFV+EaKYT6CR24nh8zWbbYUB94CIsLe1zLHn5WC5eHL3E+v4TFssVTssKi8trnDE/XFU4J8vrG1xVa5TMMuUB9qv1LS5XFesKd3RUtx9RpI20PIkkkAn/v4rF+TKLvgqFp2GfadXz7EaDYW+hjYP3Ho7431BclKtsbtNB7dCODv3eQbCWTO0ClPWwPiDGCdP0ZzjhRRbuKEySgyhlEhkfKeMbpr/LsvD12/ezsNc/ZbPQomffp2RvOOE/Cd+8W2ShEEnoIfZ+liaRsjBKIziPECOffGDKH8fzcx6YhfOEcjdA9nx2/gQLqQwka9MPsELCdgImJXuvNaJ3mIJ/Di8rTl4dA4PC5vMWTd3gC6m3LR6aDo/NE3b1I8TDhtSQNXOzhWi+QXVdZuBFw66FFi2iVijK9MshcELJCUf0RMsBioy8yI06TxSs/YFBdHbG2l81SVN+B9R48ELdeLncAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"  2\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/原因2-8476e1f72ff45b0e087e85029010b116-48538.png\\\"\\n        srcset=\\\"/static/原因2-8476e1f72ff45b0e087e85029010b116-bed0f.png 200w,\\n/static/原因2-8476e1f72ff45b0e087e85029010b116-5fd34.png 400w,\\n/static/原因2-8476e1f72ff45b0e087e85029010b116-48538.png 800w,\\n/static/原因2-8476e1f72ff45b0e087e85029010b116-b70ec.png 1200w,\\n/static/原因2-8476e1f72ff45b0e087e85029010b116-d134a.png 1600w,\\n/static/原因2-8476e1f72ff45b0e087e85029010b116-09816.png 1913w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\",\"htmlAst\":{\"type\":\"root\",\"children\":[{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"bug还没解决,如何过年?\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"不是标题党,确实是出了线上问题, 线上不间断出现oom问题,还有一周就过年了,问题不解决,如何能安心过年,过年的时候出问题,估计客户会把我们撕的碎碎的.\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"为什么说 “5块钱的bug,怎么变成了用1.5W的成本”? 如果及早发现这个问题,一个人5分钟就搞定,但我们三个人却用了5天(包含周未);\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"现象\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"在”主动发现问题行动”的推动下配置了alinode的告警,然后就有报警出现了,. \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"报警: “已用堆内存超过堆上限的 80%，当前为 82.31%“;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"再仔细一查, 不得了了.比报警内容还坏, 我们遇到的不是内存泄漏,而是oom崩溃, 而且是突发式的.一但发生立马崩溃,不给你半点时间;\\n幸好进程会自动拉起. nginx也有健康状态检查,会自动分流; \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-200f3.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.44386422976501%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABc0lEQVQoz61SXU/CQBDs3/bZB1+NCEpM0BhBrARJ9Ff47E9ATYiQAu19362z26viu4TJTuf25m62LY6OT2jx/EJ305ImD49/cF/OaFKCo47xzJh0Gvh0Nqex7CvpCR7lfEHF6esb/eevGF7fCqnqhvbaUJ2xA9Z7aND52Xsv64ymg0FPo2mzb/ca56gY3bSG1nmKMZH1gQw2OyClRCFGwS9PFMFNCOj1osWDnmJ4NRJDD3dZQGMEuEpTBq8laCCCVg8/6wyPw4qz/oUY1lpLLJ9vp3HjDeIoa+XWfHplHFXW0Rr1C1gBa20R19JKO1IhUnE+uBTDHUQncQPVFvOCYWVQwRU0jrkF37qAtYDqaZfBhyvA45ZFr98a+jwzFr1ERjRK+Lfg+LzR5WgW1aDHCk+iywx7g6EYGtO+yZDn53ErjXisxTzPD2VpqRy9H2DZWNE/AcuRO0OF1+7y/BgcfcufAkxdjqzAVY7XoWHNWHAnh34DQ6P021JG5RoAAAAASUVORK5CYII='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"cpu   \",\"title\":\"\",\"src\":\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-48538.png\",\"srcSet\":[\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-bed0f.png 200w\",\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-5fd34.png 400w\",\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-48538.png 800w\",\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-b70ec.png 1200w\",\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-d134a.png 1600w\",\"/static/cpu等数据-c788b19c61c6b80817ffa4d8cfe0d6fc-200f3.png 1915w\"],\"sizes\":[\"(max-width:\",\"800px)\",\"100vw,\",\"800px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"随后开启服务器coredump,把进程崩溃的现场信息留下来,等了一天,便可以在alinode管理端获取coredump列表.\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b9b8f.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.62565172054223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABe0lEQVQoz3WRWUsDMRSF50cLgg8+CvrghgWtWqa009YK+p9E0E5mXzJLJjneJNM6dQkccudOzpeTxDk4Oob39IzxxMWjO8Xh2MXJZA5vsYTrLTEdar7YySXNFiu4s7nR+uUV3moNZ3Q/gR6VBBqaP2hmpBZWVJp+1UsO1A1qvVaRnKvRLZK2gx+ECKIYWZKiyHNEaYpNxODTd0BK8wJJVlA/R0b1nooSSRyTr4Bzc/cAn8jaxFiAoiyhpEKnBHzO8FY1SOrWnEIphbKTZrZD6aatKvK1DZxLShhQI0wzhFGEknNIDZQCjId4J2Ba2wNJMnMCtvRfmE2VgSsD5BZ4en6NsE8YhCHKbUIDDAww6YHaXBOwlhKNtOBvYJ/w7OIHcC8hHZk3iAfAqk+o0+0n/AfIe6CQLd1hgrARKFuxA7bSJtRJdcr/gXSHrE+oeuAnLRJk7LrOGkmSIPYh1G6TX8CIGixOsGHM3KE2dQTcVAUaISHEPnBbqz8e5Qskv+7Nf51IDgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"alinodecoredump  \",\"title\":\"\",\"src\":\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-48538.png\",\"srcSet\":[\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-bed0f.png 200w\",\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-5fd34.png 400w\",\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-48538.png 800w\",\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b70ec.png 1200w\",\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-d134a.png 1600w\",\"/static/alinodecoredump列表-8fb475d6b06ce63c8e745a61219e1c61-b9b8f.png 1918w\"],\"sizes\":[\"(max-width:\",\"800px)\",\"100vw,\",\"800px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"有了这些信息,就可以开展分析工作了;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"线索\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"崩溃不定期发生,然而线上机器大概率发生, 灰度 机器并不发生;一台机器中个别进程崩溃;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"查看其他应用并没有发生崩溃的问题; \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"近期上了健康检查与全链路跟踪; \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"线上虽有崩溃,然而并没有用户反馈有问题;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"有3种崩溃的情况,不只是一种;\"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"解决角度\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"根据对coredump内容分析,有三个解决角度\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"查看heap中占比最大的对象;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"zoneContext导致;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"urllib所发出的请求导致出问题; \"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"看了之后特别怀疑问题2, 原因有两点: \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"最近我们上线了zipkin全链路跟踪;\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"zoneContex 所使用的async_hook还是实验特性 (不会入坑了吧. );\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"nginx有健康检查,会不停发请求; \"}]},{\"type\":\"text\",\"value\":\"\\n\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"线索1:查看heap中占比最大的对象\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"本以为手到病除, 然而一看coredump中对象列表就傻眼了.没有统计,没有规律,只显示object有600多M,但是什么对象就是找不到.\\n就好比告诉你凶手就在茫茫人海中,说了几乎跟没说一样.. \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/objectlist-a05ede811a97962799580ec1102498f4-3bb64.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.470219435736674%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABTklEQVQoz61S204CMRTc3/bJB/9A0GCQ4BUVCGiMv2RUILvb7b1bxtnuSngTE5tMzml7MmfOtNnR8QlmyxeMb+9xfTdJmDzN8DCdp/iT7+8n0zY+zhftPfH8+obpYomsIUhru8V/rOzicow6RryvNsiFhJAKZSWZV5DawHsPYy0s4Zg718B1sb0zxqazpjYbjW8obgupFJTRUFpDG7ODtW5HoHmnlN6RSjZvyXyqS4TD0VWSKnmgvYNioSE098qSwIfU8FBk/V6f/kWUmy8YkcPJiqPV7Fa3I9YB8U+E54OkMM8/oasCmmMoa1p1LtDftjAeTDgYJkJhVDeygXA6KavriLp5/T38SnjWKVznBV+34CsLVMrQx0BfVfJSu5rNYlLc2BFCICIcowueOS3iPsRG4WkPoBqx/oAqV/CigC9zRCptxoz8UrEbOR4w+jeYYvTBidXgwwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"objectlist\",\"title\":\"\",\"src\":\"/static/objectlist-a05ede811a97962799580ec1102498f4-48538.png\",\"srcSet\":[\"/static/objectlist-a05ede811a97962799580ec1102498f4-bed0f.png 200w\",\"/static/objectlist-a05ede811a97962799580ec1102498f4-5fd34.png 400w\",\"/static/objectlist-a05ede811a97962799580ec1102498f4-48538.png 800w\",\"/static/objectlist-a05ede811a97962799580ec1102498f4-b70ec.png 1200w\",\"/static/objectlist-a05ede811a97962799580ec1102498f4-d134a.png 1600w\",\"/static/objectlist-a05ede811a97962799580ec1102498f4-3bb64.png 1914w\"],\"sizes\":[\"(max-width:\",\"800px)\",\"100vw,\",\"800px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"尝试用概率的方法来人肉统计一次,然而次次无功而返;当然不依赖alinode对coredump进行分析,然而考虑到时间成本再试下别一个角度\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"线索2:zoneContext导致\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"朝着这个方向走,检查了zonecontext的代码,然而并没有看出什么问题, 只好忌出大法(范围缩小跟踪)\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"我们使用zonecontext的地方有两个,1) 全链路跟踪,2) dubbolog . 而 全链路跟踪是新上的功能,且是关键节点,dubbolog记录是很久上的,且业务应用也有使用\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"我们选择关闭了zipkin全链路跟踪,关闭了nginx健康检查(会发送大量请求); \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"理想总是美好的, 然而实现却啪啪啪的打脸. 把这些都关闭了线上还在出问题;囧了. 众多迹象证明问题不在zonecontext&async_hook\"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-55c5b.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.36534446764092%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABQElEQVQoz62R20oDMRRF5799EPwBL9WiWKRY6/RKKVj0p+zccptkZrY7SS31RefBwOLMIWHNSXZydn6B3fsHJukcr/MlZqs10sUKL+xny3VgOlsETvuUdbHehHOTaYrt2w6rzRbJaPwMv9q2xX+sZHD/iEwqFFkOxSqFYJXQRFZV7LWGJtLvKwWldKi+14c9peJ38vg0DuY8K5FXFJNSkEJAEqsNmqbpSYtk+DAKwk9pkCmHvbLItYOyDeq2Q3e8TBfout9JLm/uwvF9pSmsef0auZcSVTsI42Bc/LvnT+HV7TAKhRdGUantUVpwWo+sG7i2j3AQhRknzKUN0oLCgtOWnFYZi4YTdnyjro/w+iAsMsVQahSUCoZimbITEvYbJtpY13/C8IaUVZxMMCBp4jU9xrUnMCyiGZrxwbmfU38BNrX0HLADTrYAAAAASUVORK5CYII='); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"  1\",\"title\":\"\",\"src\":\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-48538.png\",\"srcSet\":[\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-bed0f.png 200w\",\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-5fd34.png 400w\",\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-48538.png 800w\",\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-b70ec.png 1200w\",\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-d134a.png 1600w\",\"/static/原因1-f157a782dc7a105fbcaeba2171ae4733-55c5b.png 1916w\"],\"sizes\":[\"(max-width:\",\"800px)\",\"100vw,\",\"800px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \"},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"className\":[\"gatsby-resp-image-link\"],\"href\":\"/static/原因2-8476e1f72ff45b0e087e85029010b116-09816.png\",\"style\":\"display: block\",\"target\":\"_blank\",\"rel\":[\"noopener\"]},\"children\":[{\"type\":\"text\",\"value\":\"\\n  \\n  \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-wrapper\"],\"style\":\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n    \"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"gatsby-resp-image-background-image\"],\"style\":\"padding-bottom: 50.54887611082071%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABdElEQVQoz52R227UMBRF8+E8VOIHqCoEiGlLp+k0HbVIFV+EaKYT6CR24nh8zWbbYUB94CIsLe1zLHn5WC5eHL3E+v4TFssVTssKi8trnDE/XFU4J8vrG1xVa5TMMuUB9qv1LS5XFesKd3RUtx9RpI20PIkkkAn/v4rF+TKLvgqFp2GfadXz7EaDYW+hjYP3Ho7431BclKtsbtNB7dCODv3eQbCWTO0ClPWwPiDGCdP0ZzjhRRbuKEySgyhlEhkfKeMbpr/LsvD12/ezsNc/ZbPQomffp2RvOOE/Cd+8W2ShEEnoIfZ+liaRsjBKIziPECOffGDKH8fzcx6YhfOEcjdA9nx2/gQLqQwka9MPsELCdgImJXuvNaJ3mIJ/Di8rTl4dA4PC5vMWTd3gC6m3LR6aDo/NE3b1I8TDhtSQNXOzhWi+QXVdZuBFw66FFi2iVijK9MshcELJCUf0RMsBioy8yI06TxSs/YFBdHbG2l81SVN+B9R48ELdeLncAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"},\"children\":[{\"type\":\"text\",\"value\":\"\\n      \"},{\"type\":\"element\",\"tagName\":\"img\",\"properties\":{\"className\":[\"gatsby-resp-image-image\"],\"style\":\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\",\"alt\":\"  2\",\"title\":\"\",\"src\":\"/static/原因2-8476e1f72ff45b0e087e85029010b116-48538.png\",\"srcSet\":[\"/static/原因2-8476e1f72ff45b0e087e85029010b116-bed0f.png 200w\",\"/static/原因2-8476e1f72ff45b0e087e85029010b116-5fd34.png 400w\",\"/static/原因2-8476e1f72ff45b0e087e85029010b116-48538.png 800w\",\"/static/原因2-8476e1f72ff45b0e087e85029010b116-b70ec.png 1200w\",\"/static/原因2-8476e1f72ff45b0e087e85029010b116-d134a.png 1600w\",\"/static/原因2-8476e1f72ff45b0e087e85029010b116-09816.png 1913w\"],\"sizes\":[\"(max-width:\",\"800px)\",\"100vw,\",\"800px\"]},\"children\":[]},{\"type\":\"text\",\"value\":\"\\n    \"}]},{\"type\":\"text\",\"value\":\"\\n  \"}]},{\"type\":\"text\",\"value\":\"\\n  \\n  \"}]},{\"type\":\"text\",\"value\":\"\\n    \"}]}],\"data\":{\"quirksMode\":false}},\"fields\":{\"slug\":\"/警告\\\"node OOM\\\"了/\",\"prefix\":\"2019-01-28\"},\"frontmatter\":{\"title\":\"bug不解决,如何过年-node OOM\",\"subTitle\":\"5块钱的bug,怎么变成了用1.5W的成本 !\",\"cover\":null}},\"author\":{\"id\":\"/Users/dong/dong/blogs/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>游大千世界,看大千世界,认知世界!</p>\"},\"footnote\":{\"id\":\"/Users/dong/dong/blogs/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>I am a coder who solves the problem<a href=\\\"/about/\\\">contact</a></p>\"},\"site\":{\"siteMetadata\":{\"facebook\":{\"appId\":\"coder.yang2001@gmail.com\"}}}},\"pathContext\":{\"slug\":\"/警告\\\"node OOM\\\"了/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/警告-node-oom-了.json\n// module id = 784\n// module chunks = 64197529879269"],"sourceRoot":""}